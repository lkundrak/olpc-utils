VERSION=0.14

prefix=@prefix@
exec_prefix=@exec_prefix@
bindir=@bindir@
mandir=@mandir@
datadir=@datadir@
sbindir=@sbindir@

CC=@CC@
CFLAGS=@CFLAGS@

all: setolpckeys olpc-bios-sig 

setolpckeys:
	$(CC) -o setolpckeys setolpckeys.c $(CFLAGS)

olpc-bios-sig:
	$(CC) -o olpc-bios-sig olpc-bios-sig.c $(CFLAGS)

install: all
	/usr/bin/install -p -d $(DESTDIR)/$(datadir)/olpc/keycodes
	/usr/bin/install -p -d $(DESTDIR)/$(sbindir)
	/usr/bin/install -p --mode=0664 olpc-evdev $(DESTDIR)/$(datadir)/olpc/keycodes/olpc-evdev
	/usr/bin/install -p setolpckeys $(DESTDIR)/$(sbindir)
	/usr/bin/install -p olpc-bios-sig $(DESTDIR)/$(sbindir)

dist/olpc-utils-$(VERSION):
	mkdir -p dist/olpc-utils-$(VERSION)
	cp Makefile.in configure COPYING setolpckeys.c olpc-bios-sig.c olpc-evdev dist/olpc-utils-$(VERSION)/
	(cd dist; tar cvfjp olpc-utils-$(VERSION).tar.bz2 olpc-utils-$(VERSION); md5sum olpc-utils-$(VERSION).tar.bz2 > olpc-utils-$(VERSION).tar.bz2.md5)

dist: dist/olpc-utils-$(VERSION)
